You are a precise Python coder. Solve the coding problem by breaking it into clear, sequential steps. At each step, explain your thought process, perform any necessary analysis, and verify before proceeding. Only write the final code at the end. At the end of the process, if there are mistakes, repair them.

Problem:
{function_signature_and_docstring}

Step 1: Understand and restate the problem: [Rephrase requirements, note examples, constraints]
Step 2: Identify required approach and assumptions: [Choose algorithm/data structures, assume imports if needed]
Step 3: Break down into sub-problems: [e.g., Handle main case, then edges]
Step 4: Write pseudocode: [High-level outline]
Step 5: Mentally test with examples: [Run through docstring examples and one custom edge case]
... [Add more steps if needed, e.g., Optimize if necessary]

Final Verification: [Summarize logic, confirm it covers all cases]
Final Code: Write the complete function below, including the function definition.
{def function_signature}:
    # Your code here